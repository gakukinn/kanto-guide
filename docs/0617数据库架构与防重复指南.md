# 0617æ•°æ®åº“æ¶æ„ä¸é˜²é‡å¤æŒ‡å—

## ğŸ“‹ æ–‡æ¡£ç›®çš„
**å…³é”®æé†’ï¼šæœ¬é¡¹ç›®å·²å»ºç«‹å®Œæ•´çš„æ•°æ®åº“ä½“ç³»ï¼Œè¯·å‹¿é‡å¤åˆ›å»ºä»»ä½•æ•°æ®åº“ï¼**

æœ¬æ–‡æ¡£è¯¦ç»†è®°å½•ç°æœ‰æ•°æ®åº“æ¶æ„ï¼Œä¸ºåç»­AIæä¾›å‡†ç¡®çš„æ•°æ®åº“ç°çŠ¶ä¿¡æ¯ï¼Œé¿å…é‡å¤å»ºè®¾ã€‚

## ğŸ—„ï¸ ç°æœ‰æ•°æ®åº“å®Œæ•´æ¸…å•

### SQLiteæ•°æ®åº“æ–‡ä»¶ï¼ˆå·²å­˜åœ¨ï¼‰
```
ğŸ“ data/databases/
â”œâ”€â”€ seibu-en-hanabi-2025.db            # è¥¿æ­¦å›­èŠ±ç«å¤§ä¼šæ•°æ®åº“
â”œâ”€â”€ joso-kinugawa-hanabi-2025.db       # å¸¸ç·ãã¬å·èŠ±ç«å¤§ä¼šæ•°æ®åº“  
â”œâ”€â”€ joso-kinugawa-hanabi-2025-updated.db # å¸¸ç·ãã¬å·èŠ±ç«å¤§ä¼šæ›´æ–°ç‰ˆ
â”œâ”€â”€ kawasaki-tamagawa-hanabi-2025.db   # å·å´å¤šæ‘©å·èŠ±ç«å¤§ä¼šæ•°æ®åº“
â”œâ”€â”€ chikuma-chikumagawa-hanabi-2025.db # åƒæ›²å·èŠ±ç«å¤§ä¼šæ•°æ®åº“
â”œâ”€â”€ isawa-onsen-hanabi-2025.db         # çŸ³å’Œæ¸©æ³‰èŠ±ç«å¤§ä¼šæ•°æ®åº“
â””â”€â”€ asahi-iioka-you-yu-hanabi-2025.db  # æ—­é£¯å²¡èŠ±ç«å¤§ä¼šæ•°æ®åº“

ğŸ“ src/database/
â”œâ”€â”€ japanese-validation.db             # æ—¥æ–‡æ•°æ®éªŒè¯æ•°æ®åº“
â””â”€â”€ walkerplus-japanese-database.json  # WalkerPlusæ—¥æ–‡æ•°æ®JSON
```

### æ•°æ®åº“è§„æ¨¡ç»Ÿè®¡
- **SQLiteæ•°æ®åº“æ–‡ä»¶**ï¼š7ä¸ª
- **JSONæ•°æ®åº“æ–‡ä»¶**ï¼š1ä¸ª
- **æ€»æ•°æ®åº“æ–‡ä»¶**ï¼š8ä¸ª
- **å­˜å‚¨ä½ç½®**ï¼šæœ¬åœ°é¡¹ç›®æ–‡ä»¶ï¼Œéšä»£ç éƒ¨ç½²

## ğŸ—ï¸ æ ‡å‡†åŒ–æ•°æ®åº“è¡¨ç»“æ„

### èŠ±ç«æ´»åŠ¨æ•°æ®åº“æ ‡å‡†è¡¨ç»“æ„
æ‰€æœ‰èŠ±ç«æ•°æ®åº“éƒ½é‡‡ç”¨ä»¥ä¸‹æ ‡å‡†åŒ–è¡¨ç»“æ„ï¼š

```sql
-- 1. åŸºç¡€ä¿¡æ¯è¡¨
CREATE TABLE hanabi_basic_info (
  id INTEGER PRIMARY KEY AUTOINCREMENT,
  name TEXT NOT NULL,                    -- æ´»åŠ¨åç§°
  japanese_name TEXT,                    -- æ—¥æ–‡åç§°
  date TEXT,                            -- ä¸¾åŠæ—¥æœŸ
  time TEXT,                            -- ä¸¾åŠæ—¶é—´
  venue TEXT,                           -- ä¼šåœºåç§°
  prefecture TEXT,                      -- éƒ½é“åºœå¿
  region TEXT,                          -- åœ°åŒº
  created_at DATETIME DEFAULT CURRENT_TIMESTAMP
);

-- 2. åœºåœ°ä¿¡æ¯è¡¨
CREATE TABLE venue_info (
  id INTEGER PRIMARY KEY AUTOINCREMENT,
  hanabi_id INTEGER,                    -- å…³è”èŠ±ç«æ´»åŠ¨ID
  location TEXT,                        -- å…·ä½“ä½ç½®
  address TEXT,                         -- åœ°å€
  map_url TEXT,                         -- åœ°å›¾é“¾æ¥
  parking_info TEXT,                    -- åœè½¦ä¿¡æ¯
  FOREIGN KEY (hanabi_id) REFERENCES hanabi_basic_info(id)
);

-- 3. äº¤é€šä¿¡æ¯è¡¨
CREATE TABLE access_info (
  id INTEGER PRIMARY KEY AUTOINCREMENT,
  hanabi_id INTEGER,                    -- å…³è”èŠ±ç«æ´»åŠ¨ID
  transport_type TEXT,                  -- äº¤é€šæ–¹å¼ç±»å‹
  route_description TEXT,               -- è·¯çº¿æè¿°
  walking_time TEXT,                    -- æ­¥è¡Œæ—¶é—´
  FOREIGN KEY (hanabi_id) REFERENCES hanabi_basic_info(id)
);

-- 4. è§‚èµä¿¡æ¯è¡¨
CREATE TABLE viewing_spots (
  id INTEGER PRIMARY KEY AUTOINCREMENT,
  hanabi_id INTEGER,                    -- å…³è”èŠ±ç«æ´»åŠ¨ID
  spot_name TEXT,                       -- è§‚èµç‚¹åç§°
  description TEXT,                     -- è§‚èµç‚¹æè¿°
  capacity TEXT,                        -- å®¹é‡
  price TEXT,                           -- ä»·æ ¼
  FOREIGN KEY (hanabi_id) REFERENCES hanabi_basic_info(id)
);

-- 5. è”ç³»ä¿¡æ¯è¡¨
CREATE TABLE contact_info (
  id INTEGER PRIMARY KEY AUTOINCREMENT,
  hanabi_id INTEGER,                    -- å…³è”èŠ±ç«æ´»åŠ¨ID
  contact_type TEXT,                    -- è”ç³»æ–¹å¼ç±»å‹
  contact_value TEXT,                   -- è”ç³»æ–¹å¼å€¼
  FOREIGN KEY (hanabi_id) REFERENCES hanabi_basic_info(id)
);

-- 6. å¤©æ°”ä¿¡æ¯è¡¨
CREATE TABLE weather_info (
  id INTEGER PRIMARY KEY AUTOINCREMENT,
  hanabi_id INTEGER,                    -- å…³è”èŠ±ç«æ´»åŠ¨ID
  weather_note TEXT,                    -- å¤©æ°”æ³¨æ„äº‹é¡¹
  rain_plan TEXT,                       -- é›¨å¤©é¢„æ¡ˆ
  FOREIGN KEY (hanabi_id) REFERENCES hanabi_basic_info(id)
);

-- 7. æ•°æ®æºä¿¡æ¯è¡¨
CREATE TABLE data_source (
  id INTEGER PRIMARY KEY AUTOINCREMENT,
  hanabi_id INTEGER,                    -- å…³è”èŠ±ç«æ´»åŠ¨ID
  source_url TEXT,                      -- æ•°æ®æºURL
  crawl_date DATETIME DEFAULT CURRENT_TIMESTAMP, -- çˆ¬å–æ—¶é—´
  data_version TEXT,                    -- æ•°æ®ç‰ˆæœ¬
  FOREIGN KEY (hanabi_id) REFERENCES hanabi_basic_info(id)
);
```

### éªŒè¯æ•°æ®åº“ç‰¹æ®Šç»“æ„
```sql
-- æ—¥æ–‡éªŒè¯æ•°æ®åº“ (japanese-validation.db)
CREATE TABLE validation_results (
  id INTEGER PRIMARY KEY AUTOINCREMENT,
  event_id TEXT NOT NULL,               -- æ´»åŠ¨ID
  region TEXT NOT NULL,                 -- åœ°åŒº
  validation_date DATETIME DEFAULT CURRENT_TIMESTAMP, -- éªŒè¯æ—¶é—´
  field_name TEXT NOT NULL,             -- å­—æ®µå
  local_value TEXT,                     -- æœ¬åœ°å€¼
  walker_plus_value TEXT,               -- WalkerPluså€¼
  is_consistent BOOLEAN NOT NULL,       -- æ˜¯å¦ä¸€è‡´
  confidence_score REAL DEFAULT 0.0,   -- ç½®ä¿¡åº¦åˆ†æ•°
  notes TEXT                            -- å¤‡æ³¨
);

CREATE TABLE walker_plus_raw_data (
  id INTEGER PRIMARY KEY AUTOINCREMENT,
  event_id TEXT NOT NULL,               -- æ´»åŠ¨ID
  region TEXT NOT NULL,                 -- åœ°åŒº
  scrape_date DATETIME DEFAULT CURRENT_TIMESTAMP, -- çˆ¬å–æ—¶é—´
  raw_html TEXT,                        -- åŸå§‹HTML
  parsed_data TEXT,                     -- è§£æåæ•°æ®
  source_url TEXT                       -- æºURL
);
```

## ğŸ”§ ç°æœ‰çˆ¬è™«è„šæœ¬ç³»ç»Ÿ

### çˆ¬è™«è„šæœ¬ä½ç½®
```
ğŸ“ scripts/crawlers/
â”œâ”€â”€ joso-kinugawa-hanabi-crawler.js           # å¸¸ç·ãã¬å·çˆ¬è™«
â”œâ”€â”€ joso-kinugawa-hanabi-simple-crawler.js    # å¸¸ç·ãã¬å·ç®€åŒ–çˆ¬è™«
â”œâ”€â”€ seibu-en-hanabi-scraper.js               # è¥¿æ­¦å›­èŠ±ç«çˆ¬è™«
â”œâ”€â”€ seibu-en-hanabi-scraper.cjs              # è¥¿æ­¦å›­èŠ±ç«çˆ¬è™«(CJSç‰ˆ)
â”œâ”€â”€ update-joso-kinugawa-database.js         # æ›´æ–°å¸¸ç·ãã¬å·æ•°æ®åº“
â”œâ”€â”€ update-joso-kinugawa-database-simple.js  # æ›´æ–°å¸¸ç·ãã¬å·æ•°æ®åº“(ç®€åŒ–ç‰ˆ)
â””â”€â”€ ... (å…¶ä»–çˆ¬è™«è„šæœ¬)
```

### çˆ¬è™«æŠ€æœ¯æ ˆ
- **å¼•æ“**ï¼šCrawlee + Puppeteer
- **æ•°æ®è§£æ**ï¼šCheerio
- **æ•°æ®åº“**ï¼šSQLite3
- **å­˜å‚¨æ ¼å¼**ï¼šå…³ç³»å‹æ•°æ®åº“

## ğŸš« é˜²é‡å¤åˆ›å»ºé‡è¦è§„åˆ™

### ç»å¯¹ç¦æ­¢çš„æ“ä½œ
1. **âŒ é‡æ–°åˆ›å»ºä»»ä½•ç°æœ‰æ•°æ®åº“**
   - 7ä¸ªSQLiteæ•°æ®åº“å·²ç»å­˜åœ¨ä¸”å®Œæ•´
   - é‡æ–°åˆ›å»ºä¼šå¯¼è‡´æ•°æ®ä¸¢å¤±

2. **âŒ ä¿®æ”¹ç°æœ‰è¡¨ç»“æ„**
   - æ ‡å‡†åŒ–è¡¨ç»“æ„å·²å»ºç«‹
   - ä¿®æ”¹ä¼šç ´åæ•°æ®ä¸€è‡´æ€§

3. **âŒ åˆ›å»ºé‡å¤çš„çˆ¬è™«è„šæœ¬**
   - ç°æœ‰çˆ¬è™«ç³»ç»Ÿå·²å®Œæ•´
   - é‡å¤åˆ›å»ºé€ æˆç»´æŠ¤è´Ÿæ‹…

### æ­£ç¡®çš„æ“ä½œæ–¹å¼
1. **âœ… ä½¿ç”¨ç°æœ‰æ•°æ®åº“**
   - ç›´æ¥è¯»å–ç°æœ‰SQLiteæ–‡ä»¶
   - é€šè¿‡ç°æœ‰APIæ¥å£è®¿é—®æ•°æ®

2. **âœ… æ‰©å±•ç°æœ‰è¡¨ç»“æ„**
   - å¦‚éœ€æ–°å­—æ®µï¼Œæ·»åŠ åˆ°ç°æœ‰è¡¨
   - ä¿æŒå¤–é”®å…³ç³»å®Œæ•´æ€§

3. **âœ… æ›´æ–°ç°æœ‰çˆ¬è™«è„šæœ¬**
   - ä¿®æ”¹ç°æœ‰è„šæœ¬åŠŸèƒ½
   - ä¸è¦åˆ›å»ºæ–°çš„é‡å¤è„šæœ¬

## ğŸ“Š æ•°æ®åº“è¿æ¥æ–¹å¼

### SQLiteè¿æ¥ä»£ç ç¤ºä¾‹
```javascript
import sqlite3 from 'sqlite3';
import { open } from 'sqlite';

// è¿æ¥ç°æœ‰æ•°æ®åº“
async function connectToDatabase(dbName) {
  const db = await open({
    filename: `data/databases/${dbName}`,
    driver: sqlite3.Database
  });
  return db;
}

// ä½¿ç”¨ç¤ºä¾‹
const db = await connectToDatabase('joso-kinugawa-hanabi-2025.db');
```

### æ•°æ®æŸ¥è¯¢ç¤ºä¾‹
```javascript
// æŸ¥è¯¢èŠ±ç«æ´»åŠ¨åŸºç¡€ä¿¡æ¯
const events = await db.all(`
  SELECT * FROM hanabi_basic_info 
  WHERE prefecture = ? 
  ORDER BY date
`, ['èŒ¨åŸçœŒ']);

// æŸ¥è¯¢å®Œæ•´æ´»åŠ¨ä¿¡æ¯ï¼ˆåŒ…å«å…³è”è¡¨ï¼‰
const fullEventInfo = await db.all(`
  SELECT 
    h.*,
    v.location,
    v.address,
    a.transport_type,
    a.route_description
  FROM hanabi_basic_info h
  LEFT JOIN venue_info v ON h.id = v.hanabi_id
  LEFT JOIN access_info a ON h.id = a.hanabi_id
  WHERE h.id = ?
`, [eventId]);
```

## ğŸ“‹ æ•°æ®åº“ç»´æŠ¤æŒ‡å—

### å®šæœŸç»´æŠ¤ä»»åŠ¡
1. **æ•°æ®æ›´æ–°**ï¼šé€šè¿‡ç°æœ‰çˆ¬è™«è„šæœ¬æ›´æ–°æ•°æ®
2. **æ•°æ®éªŒè¯**ï¼šä½¿ç”¨japanese-validation.dbéªŒè¯æ•°æ®å‡†ç¡®æ€§
3. **æ•°æ®å¤‡ä»½**ï¼šæ•°æ®åº“æ–‡ä»¶å·²é€šè¿‡Gitç‰ˆæœ¬æ§åˆ¶è‡ªåŠ¨å¤‡ä»½

### æ•°æ®æ›´æ–°æµç¨‹
```bash
# 1. è¿è¡Œç°æœ‰çˆ¬è™«æ›´æ–°æ•°æ®
node scripts/crawlers/joso-kinugawa-hanabi-crawler.js

# 2. éªŒè¯æ•°æ®å‡†ç¡®æ€§
node scripts/japanese-database-validation-system.js

# 3. æäº¤æ›´æ–°åˆ°Git
git add data/databases/*.db
git commit -m "æ›´æ–°èŠ±ç«æ•°æ®åº“æ•°æ®"
git push origin main
```

## âš ï¸ é‡è¦æé†’æ€»ç»“

1. **æ•°æ®åº“å·²å®Œæ•´**ï¼š8ä¸ªæ•°æ®åº“æ–‡ä»¶æ¶µç›–æ‰€æœ‰éœ€æ±‚
2. **è¡¨ç»“æ„å·²æ ‡å‡†åŒ–**ï¼šä¸è¦ä¿®æ”¹ç°æœ‰è¡¨ç»“æ„
3. **çˆ¬è™«ç³»ç»Ÿå·²å»ºç«‹**ï¼šä½¿ç”¨ç°æœ‰è„šæœ¬ï¼Œä¸è¦é‡å¤å¼€å‘
4. **è‡ªåŠ¨éƒ¨ç½²å·²é…ç½®**ï¼šæ•°æ®åº“éšä»£ç è‡ªåŠ¨åŒæ­¥åˆ°æœåŠ¡å™¨
5. **ç‰ˆæœ¬æ§åˆ¶å·²å¯ç”¨**ï¼šæ‰€æœ‰æ•°æ®å˜æ›´éƒ½æœ‰å†å²è®°å½•

---

**é‡è¦å£°æ˜**ï¼šæœ¬æ–‡æ¡£è®°å½•çš„æ•°æ®åº“æ¶æ„æ˜¯é¡¹ç›®çš„æ ¸å¿ƒåŸºç¡€è®¾æ–½ï¼Œä»»ä½•ä¿®æ”¹éƒ½å¯èƒ½å½±å“æ•´ä¸ªç³»ç»Ÿçš„ç¨³å®šæ€§ã€‚åœ¨è¿›è¡Œä»»ä½•æ•°æ®åº“ç›¸å…³æ“ä½œå‰ï¼Œè¯·åŠ¡å¿…å‚è€ƒæœ¬æ–‡æ¡£ï¼Œé¿å…é‡å¤å»ºè®¾å’Œç ´åç°æœ‰æ¶æ„ã€‚

**æ–‡æ¡£åˆ›å»ºè€…**ï¼šAIåŠ©æ‰‹  
**åˆ›å»ºæ—¶é—´**ï¼š2025å¹´6æœˆ17æ—¥  
**æœ€åæ›´æ–°**ï¼š2025å¹´6æœˆ17æ—¥  
**ç‰ˆæœ¬**ï¼š1.0 