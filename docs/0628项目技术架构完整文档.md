# JapanGuideé¡¹ç›®æŠ€æœ¯æ¶æ„å®Œæ•´æ–‡æ¡£

**æ–‡æ¡£ç‰ˆæœ¬**: v2.0  

**åˆå¹¶æ¥æº**: åˆå¹¶äº†3ä¸ªæŠ€æœ¯æ¶æ„ç›¸å…³æ–‡æ¡£  
**é¡¹ç›®çŠ¶æ€**: æ ¸å¿ƒåŠŸèƒ½å®Œæˆï¼Œç”Ÿäº§å°±ç»ª  

---

## ğŸ—ï¸ æ¶æ„æ€»è§ˆ

### è®¾è®¡ç†å¿µ
**é™æ€é¡µé¢ä¼˜å…ˆæ¶æ„**: å››å±‚é¡µé¢ä½¿ç”¨JSONæ–‡ä»¶å­˜å‚¨ï¼Œç®¡ç†åå°ä½¿ç”¨æ•°æ®åº“ï¼Œæ ¹æ®æ•°æ®ç‰¹æ€§é€‰æ‹©æœ€é€‚åˆçš„å­˜å‚¨æ–¹å¼ã€‚

```
æ¶æ„ç‰¹ç‚¹:
â”œâ”€â”€ é™æ€ä¼˜å…ˆ: å››å±‚é¡µé¢æœ€å¤§åŒ–é™æ€å†…å®¹ï¼Œå‡å°‘æœåŠ¡å™¨è´Ÿè½½
â”œâ”€â”€ æ•°æ®åˆ†ç¦»: JSONæ–‡ä»¶å­˜å‚¨ + æ•°æ®åº“æ··åˆæ¶æ„
â”œâ”€â”€ æ•°æ®é©±åŠ¨: åŸºäºJSONæ–‡ä»¶çš„é¡µé¢æ•°æ®ç®¡ç†
â””â”€â”€ ç»„ä»¶åŒ–: å¯å¤ç”¨çš„Reactç»„ä»¶ç³»ç»Ÿ
```

### æ ¸å¿ƒæŠ€æœ¯æ ˆ

#### å‰ç«¯æ¡†æ¶
```typescript
// Next.js 15 - ç°ä»£Reactæ¡†æ¶
const frameworkFeatures = {
  appRouter: "App Routeræ¶æ„ï¼Œæ”¯æŒåµŒå¥—å¸ƒå±€",
  serverComponents: "React Server Componentsï¼Œä¼˜åŒ–æ€§èƒ½", 
  staticGeneration: "é™æ€ç«™ç‚¹ç”Ÿæˆï¼ŒSEOå‹å¥½",
  serverSideRendering: "æœåŠ¡ç«¯æ¸²æŸ“ï¼ŒåŠ¨æ€æ•°æ®æ”¯æŒ",
  apiRoutes: "å†…ç½®APIè·¯ç”±ï¼Œåç«¯åŠŸèƒ½é›†æˆ"
};
```

#### å¼€å‘è¯­è¨€
```typescript
// TypeScript 5.x - ç±»å‹å®‰å…¨çš„JavaScript
interface TechStack {
  language: "TypeScript 5.x";
  benefits: [
    "ç¼–è¯‘æ—¶ç±»å‹æ£€æŸ¥",
    "æ›´å¥½çš„IDEæ”¯æŒ", 
    "ä»£ç å¯ç»´æŠ¤æ€§",
    "å›¢é˜Ÿåä½œæ•ˆç‡"
  ];
  configuration: "ä¸¥æ ¼æ¨¡å¼ï¼Œå…¨é¡¹ç›®è¦†ç›–";
}
```

#### æ ·å¼ç³»ç»Ÿ
```css
/* Tailwind CSS - å®ç”¨ä¼˜å…ˆçš„CSSæ¡†æ¶ */
.advantages {
  @apply 
    /* å¿«é€Ÿå¼€å‘ */ rapid-development
    /* ä¸€è‡´æ€§è®¾è®¡ */ consistent-design  
    /* å“åº”å¼å¸ƒå±€ */ responsive-layout
    /* ä¼˜åŒ–æ„å»º */ optimized-build;
}
```

#### æ•°æ®å­˜å‚¨
```prisma
// Prisma + SQLite - ç°ä»£æ•°æ®åº“å·¥å…·é“¾ï¼ˆä»…ç”¨äºç®¡ç†åå°ï¼‰
generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "sqlite"
  url      = "file:./dev.db"
}

// å››å±‚é¡µé¢ä½¿ç”¨JSONæ–‡ä»¶å­˜å‚¨
// data/activities/{id}.json - å•ä¸ªæ´»åŠ¨æ•°æ®
// data/regions/{region}/{activityType}.json - åœ°åŒºæ´»åŠ¨æ±‡æ€»
```

---

## ğŸ“± é¡µé¢æ¶æ„è®¾è®¡

### å››å±‚é¡µé¢ç»“æ„
```
é¡µé¢å±‚çº§æ¶æ„:
â”œâ”€â”€ Layer 1: é¦–é¡µ (/) 
â”‚   â””â”€â”€ æ¸²æŸ“æ–¹å¼: é™æ€ç”Ÿæˆ (SSG)
â”‚   â””â”€â”€ æ•°æ®æº: ç¡¬ç¼–ç é…ç½®
â”‚
â”œâ”€â”€ Layer 2: åœ°åŒºé¦–é¡µ (/tokyo, /saitama, ...)
â”‚   â””â”€â”€ æ¸²æŸ“æ–¹å¼: é™æ€ç”Ÿæˆ (SSG)  
â”‚   â””â”€â”€ æ•°æ®æº: é™æ€é…ç½®æ–‡ä»¶
â”‚
â”œâ”€â”€ Layer 3: æ´»åŠ¨åˆ—è¡¨é¡µ (/tokyo/hanabi, /saitama/matsuri, ...)
â”‚   â””â”€â”€ æ¸²æŸ“æ–¹å¼: æœåŠ¡ç«¯æ¸²æŸ“ (SSR)
â”‚   â””â”€â”€ æ•°æ®æº: JSONæ–‡ä»¶åŠ¨æ€è¯»å–
â”‚
â””â”€â”€ Layer 4: æ´»åŠ¨è¯¦æƒ…é¡µ (/tokyo/hanabi/activity-xxx, ...)
    â””â”€â”€ æ¸²æŸ“æ–¹å¼: é™æ€ç”Ÿæˆ (SSG)
    â””â”€â”€ æ•°æ®æº: JSONæ–‡ä»¶å­˜å‚¨
```

### å…³é”®æ¶æ„åŸåˆ™

#### 1. é™æ€é¡µé¢ä¸æ•°æ®åº“åˆ†ç¦»åŸåˆ™
```
âœ… é™æ€é¡µé¢ï¼ˆå››å±‚é¡µé¢ï¼‰ï¼šä½¿ç”¨JSONæ–‡ä»¶å­˜å‚¨ï¼Œä¸ä¾èµ–Prismaæ•°æ®åº“
âœ… åŠ¨æ€é¡µé¢ï¼ˆç®¡ç†åå°ï¼‰ï¼šä½¿ç”¨æ•°æ®åº“ï¼Œæ”¯æŒCRUDæ“ä½œ
âŒ ç¦æ­¢ï¼šåœ¨é™æ€é¡µé¢é€»è¾‘ä¸­å¼•å…¥æ•°æ®åº“ä¾èµ–
```

#### 2. æ•°æ®ä¸€è‡´æ€§ä¿è¯
```typescript
// æ•°æ®éªŒè¯æ¥å£
interface DataValidation {
  jalanStandards: {
    requiredFields: ["name", "address", "datetime", "venue", "access"];
    optionalFields: ["organizer", "price", "contact", "website", "googleMap"];
  };
  chineseLocalization: {
    noJapaneseKana: true;
    chineseCharactersOnly: true;
  };
}
```

---

## ğŸ—„ï¸ æ•°æ®æ¶æ„

### æ··åˆå­˜å‚¨ç­–ç•¥

#### JSONæ–‡ä»¶å­˜å‚¨ï¼ˆå››å±‚é¡µé¢ï¼‰
```javascript
// å•ä¸ªæ´»åŠ¨æ•°æ®ç»“æ„
{
  "id": "1751045840586",
  "name": "2025å¹´J-POP BESTä¸œäº¬ç«é©¬åœºèŠ±ç«",
  "description": "è¯¦ç»†æ´»åŠ¨æè¿°",
  "highlights": "æ´»åŠ¨äº®ç‚¹", 
  "address": "ä¸œäº¬éƒ½åºœä¸­å¸‚æ—¥å‰ç”º1-1",
  "datetime": "2025å¹´7æœˆ10æ—¥ 19:00-20:30",
  "venue": "ä¸œäº¬ç«é©¬åœº",
  "access": "JRä¸­å¤®çº¿ä¸œåºœä¸­ç«™æ­¥è¡Œ1åˆ†é’Ÿ",
  "organizer": "JRAä¸œäº¬ç«é©¬åœº",
  "price": "æŒ‡å®šå¸­3000æ—¥å…ƒèµ·",
  "contact": "042-363-3141",
  "website": "https://www.jra.go.jp/facilities/race/tokyo/",
  "googleMap": "https://maps.google.com/maps?..."
}
```

#### æ•°æ®åº“å­˜å‚¨ï¼ˆç®¡ç†åå°ï¼‰
```prisma
// æ´»åŠ¨å®ä½“ï¼ˆç®¡ç†åå°ä½¿ç”¨ï¼‰
model Activity {
  id          String   @id @default(cuid())
  region      String   // åœ°åŒºä»£ç 
  activityType String  // æ´»åŠ¨ç±»å‹
  detailLink  String?  // è¯¦æƒ…é¡µé“¾æ¥
  
  // Jalanåé¡¹æ ‡å‡†å­—æ®µ
  name        String   // 1. æ´»åŠ¨åç§°
  address     String   // 2. æ‰€åœ¨åœ°å€  
  datetime    String   // 3. å¼€å‚¬æ—¶é—´
  venue       String   // 4. å¼€å‚¬åœºæ‰€
  access      String   // 5. äº¤é€šæ–¹å¼
  organizer   String   // 6. ä¸»åŠæ–¹
  price       String   // 7. è´¹ç”¨ä¿¡æ¯
  contact     String   // 8. è”ç³»æ–¹å¼
  website     String   // 9. å®˜æ–¹ç½‘ç«™
  googleMap   String   // 10. åœ°å›¾é“¾æ¥
  
  // æ‰©å±•å­—æ®µ
  description String?  // æ´»åŠ¨æè¿°
  highlights  String?  // æ´»åŠ¨äº®ç‚¹
  status      String   @default("active")
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
  
  @@index([region, activityType, status])
}
```

---

## ğŸ”§ æ ¸å¿ƒæŠ€æœ¯å®ç°

### A. é¡µé¢ç”Ÿæˆå™¨æ ‡å‡†
```javascript
// æ ‡å‡†POSTè¯·æ±‚å‚æ•°
{
  data: Object,           // æ´»åŠ¨æ•°æ®
  activityType: string,   // æ´»åŠ¨ç±»å‹ï¼ˆhanabi, matsuriç­‰ï¼‰
  region: string,         // åœ°åŒºï¼ˆtokyo, kanagawaç­‰ï¼‰
  images: Array,          // å›¾ç‰‡æ•°ç»„
  duplicateAction: string,// é‡å¤å¤„ç†åŠ¨ä½œ
  overwriteTarget: string,// è¦†ç›–ç›®æ ‡ID
  forceOverwrite: boolean // å¼ºåˆ¶è¦†ç›–æ ‡å¿—
}

// æ ‡å‡†å“åº”æ ¼å¼
{
  success: boolean,
  message: string,
  pageUrl?: string,
  conflictData?: Object  // å†²çªæ—¶è¿”å›
}
```

### B. æ™ºèƒ½é‡å¤æ£€æµ‹ç®—æ³•
```javascript
// ç›¸ä¼¼åº¦åˆ¤æ–­æ¡ä»¶
const isDuplicate = 
  nameSimilarity >= 85 ||
  (nameSimilarity >= 75 && (areDatesSimilar || areAddressesSimilar)) ||
  (nameSimilarity >= 30 && areDatesSimilar && areAddressesSimilar);

// è®¡ç®—å‡½æ•°
function calculateSimilarity(str1, str2) {
  // ä½¿ç”¨Levenshteinè·ç¦»ç®—æ³•
  const distance = levenshteinDistance(str1, str2);
  const maxLength = Math.max(str1.length, str2.length);
  return ((maxLength - distance) / maxLength) * 100;
}
```

### C. è·¯å¾„å‘½åè§„åˆ™
```
æ ‡å‡†æ ¼å¼: /{region}/{activityType}/{detailPageFolder}
ç¤ºä¾‹: /tokyo/hanabi/activity-2025-summer-festival-abc123

ç»„æˆéƒ¨åˆ†ï¼š
- region: åœ°åŒºä»£ç ï¼ˆtokyo, kanagawaç­‰ï¼‰
- activityType: æ´»åŠ¨ç±»å‹ï¼ˆhanabi, matsuriç­‰ï¼‰  
- detailPageFolder: æ™ºèƒ½ç”Ÿæˆçš„æ–‡ä»¶å¤¹åï¼ˆactivity-å¹´ä»½-å…³é”®è¯-éšæœºIDï¼‰
```

---

## ğŸš¨ é”™è¯¯é¢„é˜²ä½“ç³»

### å¸¸è§é”™è¯¯æ¨¡å¼ä¸é¢„é˜²

#### é”™è¯¯ç±»å‹1ï¼šæ•°æ®åº“ä¾èµ–æ··æ·†
```javascript
// âŒ é”™è¯¯ï¼šåœ¨é™æ€é¡µé¢é€»è¾‘ä¸­ä½¿ç”¨Prisma
const dbRecord = await prisma.activity.findFirst({...});

// âœ… æ­£ç¡®ï¼šé™æ€é¡µé¢åªä½¿ç”¨JSONæ–‡ä»¶
const jsonData = JSON.parse(await fs.readFile(`data/activities/${id}.json`, 'utf8'));
```

#### é”™è¯¯ç±»å‹2ï¼šå­—æ®µæ˜ å°„é¡ºåºé”™è¯¯
```javascript
// âŒ é”™è¯¯ï¼šä¼˜å…ˆçº§é¡ºåºä¸å½“
description: data.eventName || data.name || data.description

// âœ… æ­£ç¡®ï¼šä¼˜å…ˆä½¿ç”¨å¤„ç†åçš„æ ‡å‡†å­—æ®µ
description: data.description || data.parsedDescription || data.name || data.eventName || ''
```

#### é”™è¯¯ç±»å‹3ï¼šè¦†ç›–åŠŸèƒ½IDå†²çª
```javascript
// âŒ é”™è¯¯ï¼šè¦†ç›–æ—¶ä»ç”Ÿæˆæ–°ID
const newId = Date.now().toString();

// âœ… æ­£ç¡®ï¼šè¦†ç›–æ—¶é‡ç”¨ç°æœ‰ID
const staticId = (isOverwrite && targetId) ? targetId : Date.now().toString();
```

### å¼€å‘æ£€æŸ¥æ¸…å•

#### é¡µé¢ç”Ÿæˆå™¨å¼€å‘æ¸…å•
- [ ] ç¡®è®¤é¡µé¢ç±»å‹ï¼ˆé™æ€/åŠ¨æ€ï¼‰
- [ ] æ£€æŸ¥æ•°æ®æºç±»å‹ï¼ˆJSON/æ•°æ®åº“ï¼‰
- [ ] éªŒè¯è·¯å¾„å‘½åè§„åˆ™
- [ ] å®ç°æ™ºèƒ½é‡å¤æ£€æµ‹
- [ ] æ·»åŠ è¦†ç›–åŠŸèƒ½æ”¯æŒ
- [ ] é…ç½®å›¾ç‰‡æœç´¢åŠŸèƒ½
- [ ] æµ‹è¯•æ‰€æœ‰é”™è¯¯åœºæ™¯
- [ ] æ·»åŠ è¯¦ç»†æ—¥å¿—è®°å½•

#### æ¨¡æ¿ç»„ä»¶å¼€å‘æ¸…å•
- [ ] æ·»åŠ "use client"æŒ‡ä»¤ï¼ˆå¦‚éœ€è¦ï¼‰
- [ ] å®šä¹‰æ¸…æ™°çš„TypeScriptæ¥å£
- [ ] å®ç°å“åº”å¼å¸ƒå±€
- [ ] ä¿æŒæ ·å¼ä¸€è‡´æ€§
- [ ] æ”¯æŒå¿…è¦çš„å­—æ®µç±»å‹
- [ ] æ·»åŠ é”™è¯¯è¾¹ç•Œå¤„ç†
- [ ] æµ‹è¯•å„ç§æ•°æ®æ ¼å¼

---

## ğŸ”„ æŒç»­æ”¹è¿›æœºåˆ¶

### ä»£ç è´¨é‡ä¿è¯
```javascript
// TypeScriptä¸¥æ ¼æ¨¡å¼é…ç½®
{
  "compilerOptions": {
    "strict": true,
    "noImplicitAny": true,
    "strictNullChecks": true,
    "noUnusedLocals": true,
    "noUnusedParameters": true
  }
}
```

### è‡ªåŠ¨åŒ–æµ‹è¯•
```javascript
// Jest + Testing Libraryæµ‹è¯•é…ç½®
describe('é¡µé¢ç”Ÿæˆå™¨', () => {
  test('JSONæ–‡ä»¶å­˜å‚¨éªŒè¯', () => {
    // æµ‹è¯•JSONæ–‡ä»¶æ­£ç¡®ç”Ÿæˆ
  });
  
  test('é‡å¤æ£€æµ‹ç®—æ³•éªŒè¯', () => {
    // æµ‹è¯•ç›¸ä¼¼åº¦è®¡ç®—å‡†ç¡®æ€§
  });
  
  test('è·¯å¾„å‘½åè§„åˆ™éªŒè¯', () => {
    // æµ‹è¯•URLè·¯å¾„ç”Ÿæˆæ­£ç¡®æ€§
  });
});
```

### æ€§èƒ½ç›‘æ§
```javascript
// é¡µé¢åŠ è½½æ€§èƒ½æŒ‡æ ‡
const performanceMetrics = {
  LCP: "< 2.5s",  // æœ€å¤§å†…å®¹ç»˜åˆ¶
  FID: "< 100ms", // é¦–æ¬¡è¾“å…¥å»¶è¿Ÿ
  CLS: "< 0.1",   // ç´¯ç§¯å¸ƒå±€åç§»
  TTFB: "< 800ms" // é¦–å­—èŠ‚æ—¶é—´
};
```

---

## ğŸ“‹ éƒ¨ç½²ä¸è¿ç»´

### éƒ¨ç½²ç¯å¢ƒ
```bash
# ç”Ÿäº§ç¯å¢ƒé…ç½®
NODE_ENV=production
NEXT_PUBLIC_SITE_URL=https://japan-guide.example.com
DATABASE_URL=file:./production.db

# æ„å»ºå‘½ä»¤
npm run build
npm start
```

### ç›‘æ§æŒ‡æ ‡
- **é¡µé¢åŠ è½½é€Ÿåº¦**: < 2ç§’
- **JSONæ–‡ä»¶è¯»å–**: < 100ms
- **æ•°æ®åº“æŸ¥è¯¢**: < 200msï¼ˆç®¡ç†åå°ï¼‰
- **é™æ€èµ„æºç¼“å­˜**: 30å¤©

---

## ğŸ“š å‚è€ƒèµ„æ–™

### å®˜æ–¹æ–‡æ¡£
- [Next.js 15 æ–‡æ¡£](https://nextjs.org/docs)
- [TypeScript æ‰‹å†Œ](https://www.typescriptlang.org/docs/)
- [Tailwind CSS æ–‡æ¡£](https://tailwindcss.com/docs)
- [Prisma æ–‡æ¡£](https://www.prisma.io/docs/)

### é¡¹ç›®ç‰¹å®šèµ„æº
- Walker Pluså®˜æ–¹æ•°æ®æº
- Jalanåé¡¹æ ‡å‡†è§„èŒƒ
- ä¸­æ–‡æœ¬åœ°åŒ–æŒ‡å—
- å›¾ç‰‡èµ„æºç®¡ç†è§„èŒƒ

---

**æ–‡æ¡£ç»´æŠ¤**: å½“æŠ€æœ¯æ¶æ„å‘ç”Ÿé‡å¤§å˜æ›´æ—¶ï¼Œè¯·åŠæ—¶æ›´æ–°æ­¤æ–‡æ¡£
**ç‰ˆæœ¬æ§åˆ¶**: ä½¿ç”¨Gitè·Ÿè¸ªæ–‡æ¡£å˜æ›´å†å² 