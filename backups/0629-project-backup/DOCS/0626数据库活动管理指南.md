# 数据库活动种类管理指南

## 📋 概述

本指南介绍如何修改数据库中的活动种类，包括Web界面和命令行两种方式。

## 🎯 支持的活动类型

项目支持以下6种活动类型：

| 类型 | 中文名称 | 数据表 |
|------|----------|--------|
| hanabi | 花火大会 | HanabiEvent |
| matsuri | 传统祭典 | MatsuriEvent |
| hanami | 花见会 | HanamiEvent |
| momiji | 红叶狩 | MomijiEvent |
| illumination | 灯光秀 | IlluminationEvent |
| culture | 文艺术 | CultureEvent |

## 🌐 Web界面管理（推荐）

### 访问方式
```
http://localhost:3000/admin/activity-manager
```

### 主要功能

#### 1. 📊 活动统计概览
- 显示每种活动类型的记录数量
- 点击卡片可查看该类型的详细活动列表

#### 2. 📋 活动列表管理
- 查看指定类型的所有活动
- 显示活动名称、地区、时间、验证状态
- 支持在线修改活动类型
- 支持删除活动记录

#### 3. 🔄 修改活动类型
- 通过下拉菜单选择目标活动类型
- 自动确认操作，防止误操作
- 实时更新统计数据

#### 4. 🗑️ 删除活动
- 支持单个活动删除
- 删除前二次确认
- 操作不可恢复，请谨慎使用

## 💻 命令行管理

### 启动命令
```bash
npm run modify-activity
```

### 功能菜单

#### 1. 查看活动统计
- 显示所有活动类型的记录数量
- 快速了解数据库现状

#### 2. 修改活动种类
- 选择源活动类型
- 输入活动ID
- 选择目标活动类型
- 确认后自动迁移数据

#### 3. 删除活动记录
- 选择活动类型
- 输入活动ID
- 确认后永久删除

#### 4. 批量修改地区
- 选择活动类型
- 批量修改指定地区的所有活动
- 适用于地区名称标准化

## ⚠️ 重要注意事项

### 数据安全
1. **备份重要**：修改前建议备份数据库
2. **不可恢复**：删除操作无法撤销
3. **事务保护**：修改类型使用数据库事务确保一致性

### 操作规范
1. **确认信息**：操作前仔细确认活动信息
2. **测试环境**：重要操作建议先在测试环境验证
3. **权限控制**：生产环境应限制管理权限

### 数据完整性
1. **关联检查**：修改前检查是否有页面文件依赖
2. **ID变更**：修改类型会生成新的活动ID
3. **链接更新**：可能需要更新相关的detailLink字段

## 🔧 故障排除

### 常见问题

#### 1. API连接失败
```
检查开发服务器是否运行
确认端口3000可访问
查看浏览器控制台错误信息
```

#### 2. 数据库连接错误
```
检查Prisma配置
确认数据库文件存在
运行 npx prisma generate 重新生成客户端
```

#### 3. 权限错误
```
确认有数据库写入权限
检查文件系统权限
验证Prisma连接配置
```

## 📝 最佳实践

### 1. 定期维护
- 定期检查数据完整性
- 清理无效或重复记录
- 统一地区名称格式

### 2. 操作记录
- 记录重要的修改操作
- 保留操作日志
- 建立变更审批流程

### 3. 数据验证
- 修改后验证页面正常显示
- 检查统计数据准确性
- 确认搜索功能正常

## 🚀 未来扩展

### 计划功能
- [ ] 批量导入/导出
- [ ] 活动合并功能
- [ ] 历史记录追踪
- [ ] 自动数据验证
- [ ] 权限角色管理

### 技术改进
- [ ] 更好的错误处理
- [ ] 实时数据同步
- [ ] 性能优化
- [ ] 移动端适配

---

**联系支持**：如有问题请联系技术团队或查看项目文档。 